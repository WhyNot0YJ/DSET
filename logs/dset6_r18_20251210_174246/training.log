2025-12-10 17:42:46,700 - WARNING - 预训练权重文件不存在: pretrained/rtdetrv2_r18vd_120e_coco_rerun_48.1.pth
2025-12-10 17:42:46,700 - INFO - 将从随机初始化开始训练
2025-12-10 17:42:47,061 - INFO - ✓ 已启用GPU优化: cudnn.benchmark=True, TF32=True
2025-12-10 17:42:47,061 - INFO - ✓ 创建DSET RT-DETR模型
2025-12-10 17:42:47,061 - INFO -   Decoder专家数量: 6
2025-12-10 17:42:47,061 - INFO -   Backbone: presnet18
2025-12-10 17:42:47,061 - INFO -   Encoder: in_channels=[128, 256, 512], expansion=0.5, num_layers=1
2025-12-10 17:42:47,061 - INFO -   Encoder MoE设计: 层间共享
2025-12-10 17:42:47,061 - INFO -   双稀疏配置（DSET核心特性，必然启用）:
2025-12-10 17:42:47,061 - INFO -     - Patch-MoE: 启用 (experts=6, top_k=3, patch_size=1)
2025-12-10 17:42:47,061 - INFO -     - Patch-level Pruning: 启用（与 Patch-MoE 兼容）
2025-12-10 17:42:47,061 - INFO -       → keep_ratio={2: 0.3}, warmup=10
2025-12-10 17:42:47,061 - INFO -   损失权重配置:
2025-12-10 17:42:47,061 - INFO -     - Token Pruning Loss: True (weight=0.005)
2025-12-10 17:42:47,062 - INFO -     - Decoder MoE: 0.05
2025-12-10 17:42:47,062 - INFO -     - Encoder MoE: 0.02
2025-12-10 17:42:47,136 - INFO - ✓ 创建数据加载器
2025-12-10 17:42:47,136 - INFO -   训练集: 5042 | 验证集: 2016
2025-12-10 17:42:47,136 - INFO -   数据加载配置: num_workers=16, prefetch_factor=4, pin_memory=True
2025-12-10 17:42:47,138 - INFO - ✓ 预训练参数组: 170 个参数, lr=1e-05
2025-12-10 17:42:47,139 - INFO - ✓ Norm层参数组: 116 个参数, lr=0.0001, wd=0
2025-12-10 17:42:47,139 - INFO - ✓ 新参数组: 79 个参数, lr=0.0001
2025-12-10 17:42:47,140 - INFO - ✓ 使用CosineAnnealingLR调度器 (eta_min=1e-6)
2025-12-10 17:42:47,140 - INFO - ✓ 学习率预热 3 epochs
2025-12-10 17:42:47,181 - INFO - ⏱️  Early Stopping: 启用 (patience=20, metric=mAP_0.5_0.95, mode=max)
2025-12-10 17:42:47,181 - INFO - 推理输出目录: logs/dset6_r18_20251210_174246/inference_samples
2025-12-10 17:43:27,547 - INFO -   ✓ 验证时Token Pruning生效: 98.26% tokens被剪枝
2025-12-10 17:44:23,910 - INFO -   ✓ 验证时Token Pruning生效: 90.11% tokens被剪枝
2025-12-10 17:45:19,937 - INFO -   ✓ 验证时Token Pruning生效: 80.11% tokens被剪枝
2025-12-10 17:46:15,624 - INFO -   ✓ 验证时Token Pruning生效: 70.00% tokens被剪枝
2025-12-10 17:47:12,623 - INFO -   ✓ 验证时Token Pruning生效: 60.00% tokens被剪枝
2025-12-10 17:48:08,518 - INFO -   ✓ 验证时Token Pruning生效: 50.00% tokens被剪枝
2025-12-10 17:49:04,688 - INFO -   ✓ 验证时Token Pruning生效: 40.00% tokens被剪枝
2025-12-10 17:50:00,194 - INFO -   ✓ 验证时Token Pruning生效: 30.00% tokens被剪枝
2025-12-10 17:50:58,758 - INFO -   ✓ 验证时Token Pruning生效: 20.00% tokens被剪枝
2025-12-10 17:51:56,664 - INFO -   ✓ 验证时Token Pruning生效: 10.00% tokens被剪枝
2025-12-10 17:52:53,429 - WARNING -   ⚠ 验证时Token Pruning未生效 (pruning_ratio=0.0)! 可能EMA模型epoch未设置
