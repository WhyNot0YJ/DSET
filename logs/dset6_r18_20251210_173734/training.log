2025-12-10 17:37:34,440 - WARNING - 预训练权重文件不存在: pretrained/rtdetrv2_r18vd_120e_coco_rerun_48.1.pth
2025-12-10 17:37:34,440 - INFO - 将从随机初始化开始训练
2025-12-10 17:37:34,481 - INFO - ✓ 已启用GPU优化: cudnn.benchmark=True, TF32=True
2025-12-10 17:37:34,481 - INFO - ✓ 创建DSET RT-DETR模型
2025-12-10 17:37:34,481 - INFO -   Decoder专家数量: 6
2025-12-10 17:37:34,481 - INFO -   Backbone: presnet18
2025-12-10 17:37:34,481 - INFO -   Encoder: in_channels=[128, 256, 512], expansion=0.5, num_layers=1
2025-12-10 17:37:34,481 - INFO -   Encoder MoE设计: 层间共享
2025-12-10 17:37:34,481 - INFO -   双稀疏配置（DSET核心特性，必然启用）:
2025-12-10 17:37:34,481 - INFO -     - Patch-MoE: 启用 (experts=6, top_k=3, patch_size=1)
2025-12-10 17:37:34,481 - INFO -     - Patch-level Pruning: 启用（与 Patch-MoE 兼容）
2025-12-10 17:37:34,481 - INFO -       → keep_ratio={2: 0.5}, warmup=10
2025-12-10 17:37:34,482 - INFO -   损失权重配置:
2025-12-10 17:37:34,482 - INFO -     - Token Pruning Loss: True (weight=0.005)
2025-12-10 17:37:34,482 - INFO -     - Decoder MoE: 0.05
2025-12-10 17:37:34,482 - INFO -     - Encoder MoE: 0.02
2025-12-10 17:37:34,574 - INFO - ✓ 创建数据加载器
2025-12-10 17:37:34,574 - INFO -   训练集: 5042 | 验证集: 2016
2025-12-10 17:37:34,574 - INFO -   数据加载配置: num_workers=16, prefetch_factor=4, pin_memory=True
2025-12-10 17:37:34,577 - INFO - ✓ 预训练参数组: 170 个参数, lr=1e-05
2025-12-10 17:37:34,578 - INFO - ✓ Norm层参数组: 116 个参数, lr=0.0001, wd=0
2025-12-10 17:37:34,579 - INFO - ✓ 新参数组: 79 个参数, lr=0.0001
2025-12-10 17:37:34,580 - INFO - ✓ 使用CosineAnnealingLR调度器 (eta_min=1e-6)
2025-12-10 17:37:34,580 - INFO - ✓ 学习率预热 3 epochs
2025-12-10 17:37:34,626 - INFO - ⏱️  Early Stopping: 启用 (patience=20, metric=mAP_0.5_0.95, mode=max)
2025-12-10 17:37:34,626 - INFO - 推理输出目录: logs/dset6_r18_20251210_173734/inference_samples
2025-12-10 17:37:34,766 - WARNING - 预训练权重文件不存在: pretrained/rtdetrv2_r18vd_120e_coco_rerun_48.1.pth
2025-12-10 17:37:34,766 - INFO - 将从随机初始化开始训练
2025-12-10 17:37:34,800 - INFO - ✓ 已启用GPU优化: cudnn.benchmark=True, TF32=True
2025-12-10 17:37:34,800 - INFO - ✓ 创建DSET RT-DETR模型
2025-12-10 17:37:34,800 - INFO -   Decoder专家数量: 6
2025-12-10 17:37:34,800 - INFO -   Backbone: presnet18
2025-12-10 17:37:34,800 - INFO -   Encoder: in_channels=[128, 256, 512], expansion=0.5, num_layers=1
2025-12-10 17:37:34,800 - INFO -   Encoder MoE设计: 层间共享
2025-12-10 17:37:34,800 - INFO -   双稀疏配置（DSET核心特性，必然启用）:
2025-12-10 17:37:34,800 - INFO -     - Patch-MoE: 启用 (experts=6, top_k=3, patch_size=1)
2025-12-10 17:37:34,800 - INFO -     - Patch-level Pruning: 启用（与 Patch-MoE 兼容）
2025-12-10 17:37:34,800 - INFO -       → keep_ratio={2: 0.9}, warmup=10
2025-12-10 17:37:34,800 - INFO -   损失权重配置:
2025-12-10 17:37:34,800 - INFO -     - Token Pruning Loss: True (weight=0.005)
2025-12-10 17:37:34,800 - INFO -     - Decoder MoE: 0.05
2025-12-10 17:37:34,800 - INFO -     - Encoder MoE: 0.02
2025-12-10 17:37:34,882 - INFO - ✓ 创建数据加载器
2025-12-10 17:37:34,882 - INFO -   训练集: 5042 | 验证集: 2016
2025-12-10 17:37:34,882 - INFO -   数据加载配置: num_workers=16, prefetch_factor=4, pin_memory=True
2025-12-10 17:37:34,884 - INFO - ✓ 预训练参数组: 170 个参数, lr=1e-05
2025-12-10 17:37:34,885 - INFO - ✓ Norm层参数组: 116 个参数, lr=0.0001, wd=0
2025-12-10 17:37:34,886 - INFO - ✓ 新参数组: 79 个参数, lr=0.0001
2025-12-10 17:37:34,886 - INFO - ✓ 使用CosineAnnealingLR调度器 (eta_min=1e-6)
2025-12-10 17:37:34,886 - INFO - ✓ 学习率预热 3 epochs
2025-12-10 17:37:34,928 - INFO - ⏱️  Early Stopping: 启用 (patience=20, metric=mAP_0.5_0.95, mode=max)
2025-12-10 17:37:34,928 - INFO - 推理输出目录: logs/dset6_r18_20251210_173734/inference_samples
