2026-01-09 23:57:25,278 - INFO - ✓ 已启用GPU优化: cudnn.benchmark=True, TF32=True
2026-01-09 23:57:25,279 - INFO - ✓ 创建DSET RT-DETR模型
2026-01-09 23:57:25,279 - INFO -   Decoder专家数量: 6
2026-01-09 23:57:25,279 - INFO -   Backbone: presnet18
2026-01-09 23:57:25,279 - INFO -   Encoder: in_channels=[128, 256, 512], expansion=0.5, num_layers=1
2026-01-09 23:57:25,279 - INFO -   Encoder MoE设计: 层间共享
2026-01-09 23:57:25,279 - INFO -   双稀疏配置（DSET核心特性，必然启用）:
2026-01-09 23:57:25,279 - INFO -     - Encoder-MoE: 启用 (experts=6, top_k=1)
2026-01-09 23:57:25,279 - INFO -     - Patch-level Pruning: 启用（与 Patch-MoE 兼容）
2026-01-09 23:57:25,279 - INFO -       → keep_ratio={2: 0.5}, warmup=10
2026-01-09 23:57:25,279 - INFO -   损失权重配置:
2026-01-09 23:57:25,279 - INFO -     - CASS Supervision: True (loss_type=vfl, weight=0.05, expansion=0.8, min_size=1.0, warmup=5 epochs)
2026-01-09 23:57:25,279 - INFO -       → CASS Loss params: alpha=2.0, beta=4.0
2026-01-09 23:57:25,279 - INFO -     - Decoder MoE: 0.01
2026-01-09 23:57:25,279 - INFO -     - Encoder MoE: 0.001
2026-01-09 23:57:25,279 - WARNING - 预训练权重文件不存在: pretrained/rtdetrv2_r18vd_120e_coco_rerun_48.1.pth
2026-01-09 23:57:25,279 - INFO - 将从随机初始化开始训练
2026-01-09 23:57:25,355 - INFO - ✓ 创建数据加载器
2026-01-09 23:57:25,355 - INFO -   训练集: 5042 | 验证集: 2016
2026-01-09 23:57:25,355 - INFO -   数据加载配置: num_workers=16, prefetch_factor=4, pin_memory=True
2026-01-09 23:57:25,357 - INFO - ✓ 预训练参数组: 150 个参数, lr=1e-05
2026-01-09 23:57:25,357 - INFO - ✓ Norm层参数组: 116 个参数, lr=0.0001, wd=0
2026-01-09 23:57:25,358 - INFO - ✓ 新参数组: 19 个参数, lr=0.0001
2026-01-09 23:57:25,358 - INFO - ✓ 使用CosineAnnealingLR调度器 (eta_min=1e-06)
2026-01-09 23:57:25,358 - INFO - ✓ 学习率预热 3 epochs
2026-01-09 23:57:25,392 - INFO - ⏱️  Early Stopping: 启用 (patience=20, metric=mAP_0.5_0.95, mode=max)
2026-01-09 23:57:25,393 - INFO - 推理输出目录: logs/dset6_r18_20260109_235725/inference_samples
2026-01-09 23:57:26,029 - INFO - ✓ 已启用GPU优化: cudnn.benchmark=True, TF32=True
2026-01-09 23:57:26,029 - INFO - ✓ 创建DSET RT-DETR模型
2026-01-09 23:57:26,029 - INFO -   Decoder专家数量: 6
2026-01-09 23:57:26,029 - INFO -   Backbone: presnet18
2026-01-09 23:57:26,029 - INFO -   Encoder: in_channels=[128, 256, 512], expansion=0.5, num_layers=1
2026-01-09 23:57:26,029 - INFO -   Encoder MoE设计: 层间共享
2026-01-09 23:57:26,029 - INFO -   双稀疏配置（DSET核心特性，必然启用）:
2026-01-09 23:57:26,029 - INFO -     - Encoder-MoE: 启用 (experts=6, top_k=1)
2026-01-09 23:57:26,029 - INFO -     - Patch-level Pruning: 启用（与 Patch-MoE 兼容）
2026-01-09 23:57:26,029 - INFO -       → keep_ratio={2: 0.5}, warmup=10
2026-01-09 23:57:26,029 - INFO -   损失权重配置:
2026-01-09 23:57:26,029 - INFO -     - CASS Supervision: True (loss_type=vfl, weight=0.05, expansion=0.8, min_size=1.0, warmup=5 epochs)
2026-01-09 23:57:26,029 - INFO -       → CASS Loss params: alpha=2.0, beta=4.0
2026-01-09 23:57:26,029 - INFO -     - Decoder MoE: 0.01
2026-01-09 23:57:26,029 - INFO -     - Encoder MoE: 0.001
2026-01-09 23:57:26,029 - WARNING - 预训练权重文件不存在: pretrained/rtdetrv2_r18vd_120e_coco_rerun_48.1.pth
2026-01-09 23:57:26,029 - INFO - 将从随机初始化开始训练
2026-01-09 23:57:26,110 - INFO - ✓ 创建数据加载器
2026-01-09 23:57:26,110 - INFO -   训练集: 5042 | 验证集: 2016
2026-01-09 23:57:26,110 - INFO -   数据加载配置: num_workers=16, prefetch_factor=4, pin_memory=True
2026-01-09 23:57:26,111 - INFO - ✓ 预训练参数组: 150 个参数, lr=1e-05
2026-01-09 23:57:26,112 - INFO - ✓ Norm层参数组: 116 个参数, lr=0.0001, wd=0
2026-01-09 23:57:26,112 - INFO - ✓ 新参数组: 19 个参数, lr=0.0001
2026-01-09 23:57:26,113 - INFO - ✓ 使用CosineAnnealingLR调度器 (eta_min=1e-06)
2026-01-09 23:57:26,113 - INFO - ✓ 学习率预热 3 epochs
2026-01-09 23:57:26,151 - INFO - ⏱️  Early Stopping: 启用 (patience=20, metric=mAP_0.5_0.95, mode=max)
2026-01-09 23:57:26,151 - INFO - 推理输出目录: logs/dset6_r18_20260109_235725/inference_samples
2026-01-09 23:57:26,224 - INFO - ✓ 创建数据加载器
2026-01-09 23:57:26,224 - INFO -   训练集: 5042 | 验证集: 2016
2026-01-09 23:57:26,224 - INFO -   数据加载配置: num_workers=16, prefetch_factor=4, pin_memory=True
